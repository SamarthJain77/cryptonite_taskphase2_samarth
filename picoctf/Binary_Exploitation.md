# format string 0

## Description
Can you use your knowledge of format strings to make the customers happy?
Download the binary here.
Download the source here.
Additional details will be available after launching your challenge instance.

## Attachments
- https://artifacts.picoctf.net/c_mimas/69/format-string-0
- https://artifacts.picoctf.net/c_mimas/69/format-string-0.c
- Connect with the challenge instance here: `nc mimas.picoctf.net 62466`

## Hints
- This is an introduction of format string vulnerabilities. Look up "format specifiers" if you have never seen them before.
- Just try out the different options.

## Writeup
After reading the challenge description and the given hints, I realized that I needed to do something with the format specifiers.
Format specifiers are used in C programming language to take input and display the output of a specific type. 
We use the `%` symbol in every format specifier. 
Format specifiers tell the compiler about the type of data that must be taken as input and the type of data that must be printed on the screen as output. 
On connecting with the challenge instance, I got to know that we are roleplaying in a newly-opened burger place `Pico 'n Patty`! 
My work was to help the picky customers find their favorite burger. 
The first customer was `Patrick` who wanted a giant bite. 
I had to choose a burger from the following options: `Breakf@st_Burger`, `Gr%114d_Cheese`, `Bac0n_D3luxe`.
Upon going through the source code file, I noticed that the program checks if the choice I made exceeds `2*BUFSIZE` bytes where `BUFSIZE` is defined as `32` bytes so I kept in mind the condition and format specifiers and chose `Gr%114d_Cheese` as it can print some garbage data inflating the count to `114` characters which exceeds the requirement of `64` bytes.
Patrick went away happily and second customer `Sponge Bob` arrived who wanted something outrageous that would break the shop. 
I had to choose a burger from the following options: `Pe%to_Portobello`, `$outhwest_Burger`, `Cla%sic_Che%s%steak`. 
Again keeping in mind the format specifiers, I chose `Cla%sic_Che%s%steak` which led me to the flag: `picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_dc0f36c4}`.

# buffer overflow 0

## Description
Let's start off simple, can you overflow the correct buffer? The program is available here. You can view source here.
Additional details will be available after launching your challenge instance.

## Attachments
- https://artifacts.picoctf.net/c/172/vuln
- https://artifacts.picoctf.net/c/172/vuln.c
- Connect using: `nc saturn.picoctf.net 53878`

## Hints
- How can you trigger the flag to print?
- If you try to do the math by hand, maybe try and add a few more characters. Sometimes there are things you aren't expecting.
- Run man gets and read the BUGS section. How many characters can the program really read?

## Writeup
After reading the challenge description and upon going through the source code file, I realized that I needed to do something with array overflow.
An array is a fixed size collection of similar data items stored in continuous memory locations.
Overflow occurs when a program tries to access or write data beyond the specified boundaries of an array.
I noticed that the `sigsegv_handler` function needs to be triggered to get the flag.
I also noticed that the `vuln` function is defined to copy the input given by user to an array named `buf2` using `strcpy` function where `buf2`  is defined as a `char` with a size of `16` bytes which means I could overflow it by giving any input longer than 16 characters.
On connecting with the challenge instance, the program asked for `Input:` where I gave the string `ABCDEFGHIJKLMNOPQRSTUVWXYZ` as the input which led me to the flag: `picoCTF{ov3rfl0ws_ar3nt_that_bad_9f2364bc}`.

# flag leak

## Description
Story telling class 1/2
I'm just copying and pasting with this program. What can go wrong? You can view source here.
Additional details will be available after launching your challenge instance.

## Attachments
- https://artifacts.picoctf.net/c/92/vuln
- https://artifacts.picoctf.net/c/92/vuln.c
- And connect with it using: `nc saturn.picoctf.net 53068`

## Hint
Format Strings

## Writeup
After reading the given hint and upon going through the source code file, I realized that I needed to do something with format string vulnerability.
It is a bug where the input given by user is directly passed as the format argument to printf, scanf or any other function of that type.
I noticed that the `vuln` function is defined to store the input given by user to an array named `story` using `scanf` function where `story`  is defined as a `char` with a size of `128` bytes and then print the array using `printf` function without using any format specifier.
I understood that an input that uses `%p` specifier can be used to print out values from the `flag` array exposing required information because `%p` prints the memory address stored in a pointer in hexadecimal and it is known that `buf` is a pointer to the `flag` array in the `readflag` and `vuln` functions respectively.
To take advantage of the known vulnerability, I connected with the challenge instance where the program asked for `Tell me a story and then I'll tell you one >>` and gave the input as `%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p` to get the output as `Here's a story - 
0xffe791100xffe791300x80493460x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x2570250x6f6369700x7b4654430x6b34334c0x5f676e310x67346c460x6666305f0x3474535f0x395f6b630x303666350x7d3731360xfbad20000xd5656a00(nil)0xf2cbc9900x804c0000x8049410(nil)0x804c0000xffe791f80x80494180x20xffe792a40xffe792b0(nil)0xffe79210(nil)(nil)0xf2ab2ed5`.
I then decoded it using the online decoder found at `https://gchq.github.io/CyberChef/#recipe=From_Hex('Auto')`, which revealed the distorted flag: `ocip{FTCk43L_gn1g4lFff0_4tS_9_kc06f5}716`.
I then made pairs of `4` characters each and reversed them manually which led me to the flag: `picoCTF{L34k1ng_Fl4g_0ff_St4ck_95f60617}`.
