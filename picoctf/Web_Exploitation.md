# SOAP

## Description
The web project was rushed and no security assessment was done. Can you read the /etc/passwd file?
Additional details will be available after launching your challenge instance.

## Attachment
http://saturn.picoctf.net:61351/

## Hint
XML external entity Injection

## Writeup
After reading the challenge description and the given hints, I realized that I needed to do something with XML External Entity Injection.
On surfing the internet, I learned that it is a web security vulnerability that allows the user to interfere with an application's processing of data giving access to files on the application server filesystem and allowing to interact with any back-end systems that the application itself can access.
Upon accessing the website, I observed that it contained three images with a `Details` button corresponding to each image but it had nothing pertinent to the challenge.
I then started inspecting the website's source code and backend files and found that whenever I clicked any button on the website, a HTTP data request was generated in the `Network` tab to display the content using the `POST` request method which was being sent from `http://saturn.picoctf.net:61351/data`.
On surfing the internet, I learned that `POST` is a request method which is used to send data to the server for server side processing to create or update resources and then get a response from the server which is displayed as output to the user's action.
Upon analyzing the HTTP request, I saw the `Request Payload` section which had the following request being sent to the server: `<?xml version="1.0" encoding="UTF-8"?><data><ID>1</ID></data>`.
I understood that I needed to exploit the vulnerability to retrieve the `/etc/passwd` file by submitting a different XXE payload.
On surfing the internet, I got to know about the standard format for submitting a XXE payload to retrieve a file:
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE data [ <!ENTITY entity_name SYSTEM "file:///path/to/file"> ]>
<root_element><element_name>&entity_name;</element_name></root_element>
```
I also learned that a custom HTTP request can be sent using `Postman`, a popular testing and development tool which is used for sending HTTP requests, receiving responses, interact with web services, test endpoints, and inspect the data being sent and received.
I downloaded it and imported the website with `/data` appended into the URL as it was needed to send the desired request.
I chose the request method as `POST` with the body format as `raw text` and created the following XXE payload by taking information from the payload I found on the website:
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE data [ <!ENTITY file SYSTEM "file:///etc/passwd"> ]>
<data><ID>&file;</ID></data>
```
I then sent the request to the server, which returned the status as `200 OK` indicating that request was successful and led me to the flag: `picoCTF{XML_3xtern@l_3nt1t1ty_e5f02dbf}`.

# Forbidden Paths

## Description
Can you get the flag?
We know that the website files live in `/usr/share/nginx/html/` and the flag is at `/flag.txt` but the website is filtering absolute file paths. Can you get past the filter to read the flag?
Additional details will be available after launching your challenge instance.

## Attachment
http://saturn.picoctf.net:56632/

## Writeup
After reading the challenge description, I realized that since absolute paths are blocked so I needed to use relative path to navigate to the root directory by using `../` repeatedly because I knew that it is used to navigate to the parent directory.
To reach `/flag.txt` from the `/usr/share/nginx/html/` directory using relative path, I kept the following directory structure in mind: `/usr/share/nginx/html/` -> `/usr/share/nginx` -> `/usr/share` -> `/usr` -> `/` and entered `../../../../flag.txt` as the filename in the desired field on the website.
Through this approach, I managed to bypass the absolute path filter returning the flag: `picoCTF{7h3_p47h_70_5ucc355_e5a6fcbc}`.

# Cookies

## Description
Who doesn't love cookies? Try to figure out the best one.

## Attachment
http://mercury.picoctf.net:29649/

## Writeup
When I accessed the website, I initially tried entering names of various cookie brands in the given field, but nothing happened. 
I then started inspecting the website's `Application` tab and found that there was a cookie already present with the `Name` set as `name` and its `Value` set to `-1`. 
After analyzing the cookie, I realized that the preset value needed to be changed to access other web pages. 
Upon hitting and trying various values, I discovered that setting the value to `18` revealed the flag: `picoCTF{3v3ry1_l0v3s_c00k135_a1f5bdb7}`.
